import React from 'react';
import ReactDOM from 'react-dom';
import ReactTestRenderer from 'react-test-renderer';
import CardView from './CardView';



// Тестовые данные эмитента
const INFO = {
    isin: 'US67021BAE92',
    name: 'NII CAPITAL',
    unknownNumber1: 7.625,
    unknownNumber2: 21,
    currency: 'USD',
    description: 'NII CAPITAL CORP, Telecommunications, NR, till 01.04.2016'
};

// Тестовые данные кривых котировок
const CURVE_DATA = {"spread":{"month":{"times":[1564938000000,1565110800000,1565283600000,1565456400000,1565629200000,1565802000000,1565974800000,1566147600000,1566320400000,1566493200000,1566666000000,1566838800000,1567011600000,1567184400000,1567357200000],"values":[31.51047945089428,35.237004298311135,35.36169595008534,34.61315574491762,37.0229146663294,40.290470914524725,38.5318249073652,41.45858526268307,43.12254877103827,46.707844657357,48.087421495479454,48.29200785358452,47.00888923490512,49.064148888152076,47.329080845017266]},"week":{"times":[1566795600000,1566838800000,1566882000000,1566925200000,1566968400000,1567011600000,1567054800000,1567098000000,1567141200000,1567184400000,1567227600000,1567270800000,1567314000000,1567357200000],"values":[29.736965687616607,28.00114944016254,31.538615496161203,34.7685806245496,36.54331600752213,38.05712992349449,41.42409842147337,40.838680651506785,40.13403807222215,43.661745323315195,45.49589909203954,49.42569295646372,52.04162990554705,50.73947784988117]},"quarter":{"times":[1560099600000,1560704400000,1561309200000,1561914000000,1562518800000,1563123600000,1563728400000,1564333200000,1564938000000,1565542800000,1566147600000,1566752400000,1567357200000],"values":[29.969947732680694,31.29904961487653,31.55340961871323,33.87904982400826,33.6731304954149,34.59239710085127,33.235758313840655,37.06823864804125,35.771200864299125,38.61483916766522,37.23965638815427,35.843799867375594,34.84732238010414]},"year":{"times":[1538370000000,1541005200000,1543640400000,1546275600000,1548910800000,1551546000000,1554181200000,1556816400000,1559451600000,1562086800000,1564722000000,1567357200000],"values":[30.628468011533094,32.79004953539294,34.45770168928247,36.53199899861067,34.75051908385551,36.695610128862604,35.448716845317506,38.36005566450477,36.7359764623812,39.31631828620485,42.56990472167104,44.4849732407432]},"max":{"times":[1480870800000,1488733200000,1496595600000,1504458000000,1512320400000,1520182800000,1528045200000,1535907600000,1543770000000,1551632400000,1559494800000,1567357200000],"values":[31.09058917948103,29.43022949092167,32.31178793314101,32.4439449145604,32.17292528669063,34.474170482636666,37.611955545189,39.408884766889834,40.42126654134077,44.210509882367006,48.13382770379317,49.4218393961079]}},"price":{"month":{"times":[1564938000000,1565110800000,1565283600000,1565456400000,1565629200000,1565802000000,1565974800000,1566147600000,1566320400000,1566493200000,1566666000000,1566838800000,1567011600000,1567184400000,1567357200000],"values":[29.650291847351227,31.22672119619989,34.48704537214707,35.4234884783139,35.07631707037929,37.75518678466841,39.92802895342103,41.986686727660356,41.55224947674393,41.38567211299607,42.751922756506346,45.08701015672051,43.89512545978597,47.570079212946794,48.004200857537846]},"week":{"times":[1566795600000,1566838800000,1566882000000,1566925200000,1566968400000,1567011600000,1567054800000,1567098000000,1567141200000,1567184400000,1567227600000,1567270800000,1567314000000,1567357200000],"values":[29.814066915908818,27.982856382720012,28.40785383853727,31.324816958223394,30.01126339012353,29.858346607496944,33.430082044257986,36.91568605888516,40.72126949123646,43.83547731654535,43.16749026792185,44.61395822424273,46.561614866092675,50.028932319181976]},"quarter":{"times":[1560099600000,1560704400000,1561309200000,1561914000000,1562518800000,1563123600000,1563728400000,1564333200000,1564938000000,1565542800000,1566147600000,1566752400000,1567357200000],"values":[32.446389119972565,31.446455930628318,29.939786057444557,32.90072970059809,34.589260878948664,37.56424691028837,39.895060994115426,41.60786694391038,43.49164659748336,42.04645271575518,45.78663126063643,46.084598102125305,47.68832620038149]},"year":{"times":[1538370000000,1541005200000,1543640400000,1546275600000,1548910800000,1551546000000,1554181200000,1556816400000,1559451600000,1562086800000,1564722000000,1567357200000],"values":[29.901385308597906,32.733876953260456,33.32232448354261,34.201924665293014,33.02773119985511,35.292820417721956,38.382160612468226,40.90445346907846,44.24055379353742,45.61536544836344,48.05097227371515,48.60053523027038]},"max":{"times":[1480870800000,1488733200000,1496595600000,1504458000000,1512320400000,1520182800000,1528045200000,1535907600000,1543770000000,1551632400000,1559494800000,1567357200000],"values":[33.28485019311751,35.59182857727109,37.03161627567775,36.70380721665451,34.764953599838,34.15376172689193,35.73247273392498,36.57869908293632,36.364871243692455,37.63246039048158,41.024930843306116,40.994280388183725]}},"yield":{"month":{"times":[1564938000000,1565110800000,1565283600000,1565456400000,1565629200000,1565802000000,1565974800000,1566147600000,1566320400000,1566493200000,1566666000000,1566838800000,1567011600000,1567184400000,1567357200000],"values":[32.011334456770875,34.125946842110956,36.41883503132462,39.71890863967646,41.708480685635216,42.24478478375155,42.17459453012674,44.920668219768956,44.85724658258959,46.908637614236405,48.46866884652293,47.47020645689526,50.19293956579282,50.24868519507266,52.46385051900316]},"week":{"times":[1566795600000,1566838800000,1566882000000,1566925200000,1566968400000,1567011600000,1567054800000,1567098000000,1567141200000,1567184400000,1567227600000,1567270800000,1567314000000,1567357200000],"values":[30.473054680453224,29.874470181969265,28.861464784670723,28.936966193145825,31.791144197733402,32.279536067591614,34.03837878919715,36.1510695207014,37.850841096588596,39.046800233395594,42.76486280137826,45.12294373146177,47.09313513035108,46.95559338891022]},"quarter":{"times":[1560099600000,1560704400000,1561309200000,1561914000000,1562518800000,1563123600000,1563728400000,1564333200000,1564938000000,1565542800000,1566147600000,1566752400000,1567357200000],"values":[28.86323991170289,31.28442445627595,31.43924878264241,34.07337935809843,33.48310094800232,33.44152742187989,37.351514329985726,39.797731440575994,41.40718215601735,40.425278638676104,44.02786135734361,43.99146050947197,46.01097895108474]},"year":{"times":[1538370000000,1541005200000,1543640400000,1546275600000,1548910800000,1551546000000,1554181200000,1556816400000,1559451600000,1562086800000,1564722000000,1567357200000],"values":[28.3159093549698,28.67233283441292,32.485523464023245,33.03034611247015,36.75875877317974,37.6378590125484,37.957965463748,37.8789451699362,36.11119960120578,35.24897793715497,36.20441055187135,39.994557898126736]},"max":{"times":[1480870800000,1488733200000,1496595600000,1504458000000,1512320400000,1520182800000,1528045200000,1535907600000,1543770000000,1551632400000,1559494800000,1567357200000],"values":[33.398036790804674,31.409864309554333,34.320545711851025,35.20921305568031,37.21420101176944,39.502310364121435,41.79962453293356,43.10656619691626,42.31655720278003,40.350646111846835,42.72145557188741,44.225292571911105]}}};

// Тестовая таблица
const paramsTable = [
    [undefined, undefined],
    [undefined, 'week'],
    [undefined, 'month'],
    [undefined, 'quarter'],
    [undefined, 'year'],
    [undefined, 'max'],
    ['price', undefined],
    ['price', 'week'],
    ['price', 'month'],
    ['price', 'quarter'],
    ['price', 'year'],
    ['price', 'max'],

    ['spread', 'week'],
    ['spread', 'month'],
    ['spread', 'quarter'],
    ['spread', 'year'],
    ['spread', 'max'],

    ['yield', 'week'],
    ['yield', 'month'],
    ['yield', 'quarter'],
    ['yield', 'year'],
    ['yield', 'max']
];



describe('Component CardView', () => {
    it.each(paramsTable)(`Renders without crashing (variant %#: %s, %s)`, (type, period) => {
        const {times, values} = CURVE_DATA[type || 'price'][period || 'week'];
        const div = document.createElement('div');
        ReactDOM.render(
            <CardView
                {...INFO}
                type={type}
                period={period}
                times={times}
                values={values}
                onChangeType={() => {}}
                onChangePeriod={() => {}}
            />, div);
        ReactDOM.unmountComponentAtNode(div);
    });

    it.each(paramsTable)(`Snapshots is correct (variant %#: %s, %s)`, (type, period) => {
        const {times, values} = CURVE_DATA[type || 'price'][period || 'week'];
        const cmp = ReactTestRenderer.create(
            <CardView
                {...INFO}
                type={type}
                period={period}
                times={times}
                values={values}
                onChangeType={() => {}}
                onChangePeriod={() => {}}
            />
        );
        const tree = cmp.toJSON();
        expect(tree).toMatchSnapshot();
    });
});
